\include{../../lib.tex}

\title{Program R w zastosowaniach ekonomicznych i finansowych. Praca domowa 2.}
\author{Andrzej Radzimiński, numer albumu: 429586}
\date{}

\begin{document}

\renewcommand{\contentsname}{Spis treści}

\setlength{\parindent}{0pt}
\noindent

\maketitle

% \tableofcontents

% \vspace{20px}

\section*{Treść zadania (moduł 5)}

\underline{Na danych umieszczonych na kursie}

\begin{itemize}
    \item[a)] proszę wybrać dane dla jednego roku (np. do nowego obiektu), a następnie proszę dla
    każdego województwa przygotować podstawowe podsumowania wybranej zmiennej
    (liczbowej) -- proszę użyć odpowiedniej funkcji, tak żeby podział na województwa był
    automatyczny; w tym punkcie można napisać kilka słów komentarza;

    
    \item[b)] proszę przygotować odpowiednią tabelę pokazującą liczbę powiatów w kontekście
    nakładów inwestycyjnych w przedsiębiorstwach na jednego mieszkańca w
    poszczególnych latach (wskazówka: jedna z danych ma charakter ciągły -- sposób
    poradzenia sobie z tym problemem należy odszukać w przykładach z materiałów);

    \item[c)] proszę przygotować stworzoną w poprzednim punkcie tabelę w wartościach
    procentowych -- jaki wymiar powinien być bazą 100\%?

    \item[d)] proszę sprawdzić (dodając odpowiednie podsumowanie do tabeli z p. b), czy w każdym
    roku jest taka sama liczba powiatów.
\end{itemize}

\underline{Proszę pamiętać o komentarzu do wyników (może być łącznie do punktów b)-d).}

\newpage

\section*{Kod}

\begin{lstlisting}[language=R]
options("width"=100)

data_file <- paste(getwd(), "/dane/DaneR.csv", sep="")
dane <- read.csv(data_file, header=TRUE, sep=";", dec=",", encoding="UTF-8")

# # # # # # # # #
#  Podpunkt a:  #
# # # # # # # # #

# wybrany rok: 2012

dane2012 <- dane[dane$Rok == 2012,]
by(dane2012$XA20, dane2012$Wojewodztwo, summary)


# # # # # # # # #
#  Podpunkt b:  #
# # # # # # # # #

# Mnożymy przez 1e6, aby przeliczyć miliony na jedności:
dane$naklad_na_mieszkanca <- (dane$XA17 * 1e6) / dane$XA29
tabela <- table(cut(dane$naklad_na_mieszkanca, breaks=10), dane$Rok)
tabela


# # # # # # # # #
#  Podpunkt c:  #
# # # # # # # # #

# Wymiar 100% -- sumaryczna liczba województw
round(prop.table(tabela,2),2) 


# # # # # # # # #
#  Podpunkt d:  #
# # # # # # # # #

liczba_lat <- ncol(tabela)
liczba_w = replicate(liczba_lat, 0)
for (i in 1:liczba_lat) {
    liczba_w[i] <- sum(tabela[,i])
}
liczba_w
    
\end{lstlisting}

\section*{Wyniki i opisy}

\end{document}

